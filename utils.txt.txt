utitlity functions for version 2